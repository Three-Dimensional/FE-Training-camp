<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç­çº§ç¼´è´¹ç»Ÿè®¡ç³»ç»Ÿ</title>
    <!-- å¼•å…¥Element UIæ ·å¼ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/element-ui@2.15.13/lib/theme-chalk/index.css">
    <!-- å¼•å…¥Vue 2 -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.14/dist/vue.js"></script>
    <!-- å¼•å…¥Element UIç»„ä»¶ -->
    <script src="https://cdn.jsdelivr.net/npm/element-ui@2.15.13/lib/index.js"></script>
    <!-- è‡ªå®šä¹‰æ ·å¼ -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #f5f7fa;
            padding: 20px;
        }

        .app-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* ç»Ÿè®¡å¡ç‰‡æ ·å¼ */
        .stats-row {
            margin-bottom: 20px;
        }

        .stat-card {
            height: 120px;
            padding: 15px;
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .stat-content {
            display: flex;
            align-items: center;
            height: 100%;
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #fff;
            margin-right: 15px;
        }

        /* æ€»åº”æ”¶ï¼ˆè“è‰²ï¼‰ */
        .receivable .stat-icon {
            background-color: #409EFF;
        }

        /* æ€»å®æ”¶ï¼ˆç»¿è‰²ï¼‰ */
        .paid .stat-icon {
            background-color: #67C23A;
        }

        /* æ€»æ¬ è´¹ï¼ˆçº¢è‰²ï¼‰ */
        .arrears .stat-icon {
            background-color: #F56C6C;
        }

        .stat-info {
            flex: 1;
        }

        .stat-value {
            font-size: 22px;
            font-weight: 700;
            color: #1f2d3d;
            margin-bottom: 5px;
        }

        .stat-desc {
            font-size: 14px;
            color: #909399;
        }

        /* ç­›é€‰æ æ ·å¼ */
        .filter-bar {
            background-color: #fff;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }

        .filter-form {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }

        .filter-form .el-form-item {
            margin-bottom: 0;
        }

        /* è¡¨æ ¼æ ·å¼ */
        .class-table {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .el-table__empty-block {
            min-height: 200px;
        }

        .el-table__empty-text {
            color: #909399;
            font-size: 14px;
        }

        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 1200px) {
            .stats-row .el-col {
                margin-bottom: 20px;
            }
        }

        @media (max-width: 768px) {
            .filter-form {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div id="app" class="app-container">
        <!-- ç»Ÿè®¡å¡ç‰‡åŒºåŸŸ -->
        <el-row class="stats-row" :gutter="20">
            <!-- æ€»åº”æ”¶é‡‘é¢ -->
            <el-col :span="8">
                <div class="stat-card receivable">
                    <div class="stat-content">
                        <div class="stat-icon">
                            <i class="el-icon-document"></i> <!-- æ–‡æ¡£å›¾æ ‡ï¼ˆå¯¹åº”åº”æ”¶ï¼‰ -->
                        </div>
                        <div class="stat-info">
                            <div class="stat-value">{{ totalReceivable | currency }}</div>
                            <div class="stat-desc">å…±{{ totalStudents }}åå­¦ç”Ÿ</div>
                        </div>
                    </div>
                </div>
            </el-col>

            <!-- æ€»å®æ”¶é‡‘é¢ -->
            <el-col :span="8">
                <div class="stat-card paid">
                    <div class="stat-content">
                        <div class="stat-icon">
                            <i class="el-icon-check"></i> <!-- å¯¹å‹¾å›¾æ ‡ï¼ˆå¯¹åº”å®æ”¶ï¼‰ -->
                        </div>
                        <div class="stat-info">
                            <div class="stat-value">{{ totalPaid | currency }}</div>
                            <div class="stat-desc">å·²ç¼´è´¹ç‡: {{ paidRate }}%</div>
                        </div>
                    </div>
                </div>
            </el-col>

            <!-- æ€»æ¬ è´¹é‡‘é¢ -->
            <el-col :span="8">
                <div class="stat-card arrears">
                    <div class="stat-content">
                        <div class="stat-icon">
                            <i class="el-icon-warning"></i> <!-- è­¦å‘Šå›¾æ ‡ï¼ˆå¯¹åº”æ¬ è´¹ï¼‰ -->
                        </div>
                        <div class="stat-info">
                            <div class="stat-value">{{ totalArrears | currency }}</div>
                            <div class="stat-desc">å…±{{ totalArrearsStudents }}åå­¦ç”Ÿæ¬ è´¹</div>
                        </div>
                    </div>
                </div>
            </el-col>
        </el-row>

        <!-- ç­›é€‰åŒºåŸŸ -->
        <div class="filter-bar">
            <el-form class="filter-form" :inline="true">
                <!-- å¹´ä»½é€‰æ‹© -->
                <el-form-item label="å¹´ä»½">
                    <el-select v-model="filter.year" placeholder="è¯·é€‰æ‹©å¹´ä»½" style="width: 120px;">
                        <el-option label="2025å¹´" value="2025"></el-option>
                        <el-option label="2024å¹´" value="2024"></el-option>
                        <el-option label="2023å¹´" value="2023"></el-option>
                    </el-select>
                </el-form-item>

                <!-- ç³»éƒ¨é€‰æ‹© -->
                <el-form-item label="ç³»éƒ¨">
                    <el-select v-model="filter.department" placeholder="æ‰€æœ‰ç³»éƒ¨" style="width: 180px;">
                        <el-option label="æ‰€æœ‰ç³»éƒ¨" value=""></el-option>
                        <el-option label="è®¡ç®—æœºç³»" value="è®¡ç®—æœºç³»"></el-option>
                        <el-option label="ç”µå­ç³»" value="ç”µå­ç³»"></el-option>
                        <el-option label="æœºæ¢°ç³»" value="æœºæ¢°ç³»"></el-option>
                        <el-option label="åœŸæœ¨ç³»" value="åœŸæœ¨ç³»"></el-option>
                    </el-select>
                </el-form-item>

                <!-- æœç´¢æ¡† -->
                <el-form-item style="flex: 1;">
                    <el-input 
                        v-model="filter.keyword" 
                        placeholder="æœç´¢ç­çº§ã€ä¸“ä¸šæˆ–ç³»éƒ¨..." 
                        prefix-icon="el-icon-search"
                        style="width: 100%;"
                    ></el-input>
                </el-form-item>

                <!-- åˆ·æ–°æŒ‰é’® -->
                <el-form-item>
                    <el-button type="primary" icon="el-icon-refresh" @click="refreshData">åˆ·æ–°æ•°æ®</el-button>
                </el-form-item>
            </el-form>
        </div>

        <!-- ç­çº§ç¼´è´¹ç»Ÿè®¡è¡¨æ ¼ -->
        <el-table 
            :data="filteredClasses" 
            class="class-table" 
            border 
            stripe 
            empty-text="æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ç­çº§ç»Ÿè®¡è®°å½•"
        >
            <el-table-column prop="className" label="ç­çº§åç§°" min-width="150"></el-table-column>
            <el-table-column prop="department" label="æ‰€å±ç³»éƒ¨" min-width="120"></el-table-column>
            <el-table-column prop="major" label="ä¸“ä¸š" min-width="120"></el-table-column>
            <el-table-column prop="totalStudents" label="å­¦ç”Ÿæ€»æ•°" align="center" width="100"></el-table-column>
            <el-table-column prop="receivable" label="æ€»åº”æ”¶" align="right" width="120">
                <template slot-scope="scope">{{ scope.row.receivable | currency }}</template>
            </el-table-column>
            <el-table-column prop="paid" label="æ€»å®æ”¶" align="right" width="120">
                <template slot-scope="scope">{{ scope.row.paid | currency }}</template>
            </el-table-column>
            <el-table-column prop="arrears" label="æ€»æ¬ è´¹" align="right" width="120">
                <template slot-scope="scope">{{ scope.row.arrears | currency }}</template>
            </el-table-column>
            <el-table-column prop="paidCount" label="å·²ç¼´è´¹äººæ•°" align="center" width="120"></el-table-column>
            <el-table-column prop="partialCount" label="éƒ¨åˆ†ç¼´è´¹äººæ•°" align="center" width="140"></el-table-column>
            <el-table-column prop="unpaidCount" label="æœªç¼´è´¹äººæ•°" align="center" width="120"></el-table-column>
            <el-table-column label="æ“ä½œ" align="center" width="100">
                <template slot-scope="scope">
                    <el-button 
                        size="small" 
                        type="primary" 
                        icon="el-icon-view" 
                        @click="viewDetail(scope.row)"
                    >æŸ¥çœ‹</el-button>
                </template>
            </el-table-column>
        </el-table>
    </div>

    <script>
        new Vue({
            el: '#app',
            data() {
                return {
                    // ç­›é€‰æ¡ä»¶ï¼ˆåŒå‘ç»‘å®šï¼‰
                    filter: {
                        year: '2025',       // é»˜è®¤é€‰ä¸­2025å¹´
                        department: '',     // é»˜è®¤æ‰€æœ‰ç³»éƒ¨
                        keyword: ''         // æœç´¢å…³é”®è¯
                    },
                    // ç­çº§ç¼´è´¹åŸå§‹æ•°æ®ï¼ˆæ¨¡æ‹Ÿæ¥å£è¿”å›ï¼‰
                    classList: []
                };
            },
            computed: {
                // ğŸ” ç­›é€‰åçš„ç­çº§åˆ—è¡¨ï¼ˆå®æ—¶å“åº”ç­›é€‰æ¡ä»¶å˜åŒ–ï¼‰
                filteredClasses() {
                    const { year, department, keyword } = this.filter;
                    return this.classList.filter(cls => {
                        // 1. å¹´ä»½ç­›é€‰ï¼ˆåŒ¹é…ç­çº§çš„yearå±æ€§ï¼‰
                        if (year && cls.year !== year) return false;
                        // 2. ç³»éƒ¨ç­›é€‰ï¼ˆç©ºè¡¨ç¤ºæ‰€æœ‰ç³»éƒ¨ï¼‰
                        if (department && cls.department !== department) return false;
                        // 3. å…³é”®è¯ç­›é€‰ï¼ˆç­çº§åç§°ã€ä¸“ä¸šã€ç³»éƒ¨æ¨¡ç³ŠåŒ¹é…ï¼‰
                        if (keyword) {
                            const lowerKeyword = keyword.toLowerCase();
                            return cls.className.toLowerCase().includes(lowerKeyword) ||
                                   cls.major.toLowerCase().includes(lowerKeyword) ||
                                   cls.department.toLowerCase().includes(lowerKeyword);
                        }
                        return true;
                    });
                },

                // ğŸ“Š æ€»åº”æ”¶é‡‘é¢ï¼ˆç­›é€‰åç­çº§çš„åº”æ”¶æ€»å’Œï¼‰
                totalReceivable() {
                    return this.filteredClasses.reduce((sum, cls) => sum + cls.receivable, 0);
                },

                // ğŸ“Š æ€»å®æ”¶é‡‘é¢ï¼ˆç­›é€‰åç­çº§çš„å®æ”¶æ€»å’Œï¼‰
                totalPaid() {
                    return this.filteredClasses.reduce((sum, cls) => sum + cls.paid, 0);
                },

                // ğŸ“Š æ€»æ¬ è´¹é‡‘é¢ï¼ˆæ€»åº”æ”¶ - æ€»å®æ”¶ï¼‰
                totalArrears() {
                    return this.totalReceivable - this.totalPaid;
                },

                // ğŸ“Š æ€»å­¦ç”Ÿæ•°ï¼ˆç­›é€‰åç­çº§çš„å­¦ç”Ÿæ€»æ•°ï¼‰
                totalStudents() {
                    return this.filteredClasses.reduce((sum, cls) => sum + cls.totalStudents, 0);
                },

                // ğŸ“Š å·²ç¼´è´¹ç‡ï¼ˆæ€»å®æ”¶/æ€»åº”æ”¶ * 100ï¼Œä¿ç•™2ä½å°æ•°ï¼‰
                paidRate() {
                    if (this.totalReceivable === 0) return '0.00';
                    return ((this.totalPaid / this.totalReceivable) * 100).toFixed(2);
                },

                // ğŸ“Š æ€»æ¬ è´¹å­¦ç”Ÿæ•°ï¼ˆç­›é€‰åç­çº§çš„æœªç¼´è´¹äººæ•°æ€»å’Œï¼‰
                totalArrearsStudents() {
                    return this.filteredClasses.reduce((sum, cls) => sum + cls.unpaidCount, 0);
                }
            },
            filters: {
                // ğŸ’´ è´§å¸æ ¼å¼åŒ–è¿‡æ»¤å™¨ï¼ˆæ·»åŠ Â¥ç¬¦å·ã€åƒåˆ†ä½ã€ä¿ç•™2ä½å°æ•°ï¼‰
                currency(value) {
                    if (typeof value !== 'number') value = 0;
                    return `Â¥${value.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
                }
            },
            methods: {
                // ğŸ”„ åˆ·æ–°æ•°æ®ï¼ˆæ¨¡æ‹Ÿä»æ¥å£è·å–æ•°æ®ï¼‰
                refreshData() {
                    this.$loading({ text: 'æ­£åœ¨åˆ·æ–°æ•°æ®...', background: 'rgba(0,0,0,0.1)' });
                    setTimeout(() => {
                        // æ¨¡æ‹Ÿæ¥å£è¿”å›çš„ç­çº§æ•°æ®ï¼ˆå¯æ›¿æ¢ä¸ºçœŸå®æ¥å£è¯·æ±‚ï¼‰
                        this.classList = [
                            {
                                year: '2025',
                                className: '2025çº§è®¡ç®—æœº1ç­',
                                department: 'è®¡ç®—æœºç³»',
                                major: 'è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯',
                                totalStudents: 50,
                                receivable: 500000,  // æ€»åº”æ”¶50ä¸‡
                                paid: 450000,        // æ€»å®æ”¶45ä¸‡
                                paidCount: 45,       // å·²ç¼´è´¹45äºº
                                partialCount: 3,     // éƒ¨åˆ†ç¼´è´¹3äºº
                                unpaidCount: 2       // æœªç¼´è´¹2äºº
                            },
                            {
                                year: '2025',
                                className: '2025çº§ç”µå­1ç­',
                                department: 'ç”µå­ç³»',
                                major: 'ç”µå­ä¿¡æ¯å·¥ç¨‹',
                                totalStudents: 45,
                                receivable: 450000,
                                paid: 400000,
                                paidCount: 40,
                                partialCount: 2,
                                unpaidCount: 3
                            },
                            {
                                year: '2025',
                                className: '2025çº§æœºæ¢°1ç­',
                                department: 'æœºæ¢°ç³»',
                                major: 'æœºæ¢°å·¥ç¨‹',
                                totalStudents: 48,
                                receivable: 480000,
                                paid: 420000,
                                paidCount: 42,
                                partialCount: 4,
                                unpaidCount: 2
                            },
                            {
                                year: '2024',
                                className: '2024çº§åœŸæœ¨1ç­',
                                department: 'åœŸæœ¨ç³»',
                                major: 'åœŸæœ¨å·¥ç¨‹',
                                totalStudents: 52,
                                receivable: 520000,
                                paid: 480000,
                                paidCount: 48,
                                partialCount: 2,
                                unpaidCount: 2
                            }
                        ];
                        // è®¡ç®—æ¯ä¸ªç­çº§çš„æ¬ è´¹é‡‘é¢ï¼ˆæ€»åº”æ”¶ - æ€»å®æ”¶ï¼‰
                        this.classList.forEach(cls => {
                            cls.arrears = cls.receivable - cls.paid;
                        });
                        this.$loading().close();
                        this.$message.success('æ•°æ®åˆ·æ–°æˆåŠŸï¼');
                    }, 1200);
                },

                // ğŸ‘ï¸ æŸ¥çœ‹è¯¦æƒ…ï¼ˆå¯æ‰©å±•ä¸ºå¼¹çª—æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼‰
                viewDetail(row) {
                    this.$alert(`
                        <h3>${row.className} ç¼´è´¹è¯¦æƒ…</h3>
                        <p>æ‰€å±ç³»éƒ¨ï¼š${row.department}</p>
                        <p>ä¸“ä¸šï¼š${row.major}</p>
                        <p>å­¦ç”Ÿæ€»æ•°ï¼š${row.totalStudents}äºº</p>
                        <p>æ€»åº”æ”¶ï¼š${row.receivable | currency}</p>
                        <p>æ€»å®æ”¶ï¼š${row.paid | currency}</p>
                        <p>æ€»æ¬ è´¹ï¼š${row.arrears | currency}</p>
                        <p>å·²ç¼´è´¹äººæ•°ï¼š${row.paidCount}äºº</p>
                        <p>éƒ¨åˆ†ç¼´è´¹äººæ•°ï¼š${row.partialCount}äºº</p>
                        <p>æœªç¼´è´¹äººæ•°ï¼š${row.unpaidCount}äºº</p>
                    `, 'ç­çº§ç¼´è´¹è¯¦æƒ…', {
                        dangerouslyUseHTMLString: true,
                        confirmButtonText: 'å…³é—­'
                    });
                }
            },
            mounted() {
                // åˆå§‹åŒ–åŠ è½½æ•°æ®
                this.refreshData();
            }
        });
    </script>
</body>
</html>

